/*
	POWERED BY 子若
	
	演示:
	<div id="slide">
		<div class="relative">
			<ul class="absolute">
				<li></li>
				...
				<li></li>
			</ul>
		</div>
	</div>
	<script>$("#slide").Zslide({boxRe:".relative",boxAb:".absolute"});</script>
	
	参数：
	type:"slide",		//类型
	boxRe:".box_re",	//相对定位元素
	boxAb:".box_ab",	//绝对定位元素
	left:"#t_l",		//左按钮
	right:"#t_r",		//右按钮
	chd:"li",			//移动元素
	autoHeight:true,	//相对,绝对定位元素自动高度		
	seeNum:4,			//可视个数
	slideNum:1,			//滚动个数
	isTurn:false,		//是否前后可逆
	border:null,		//边框大小	1,2,3,...,+∞	左右分开
	autoSlide:false,	//自动滚动
	slideTime:3000		//滚动时间	ms
*/
(function(a){a.fn.Zslide=function(o){a.fn.Zslide.defaults={type:"slide",boxRe:".box_re",boxAb:".box_ab",left:"#t_l",right:"#t_r",chd:"li",autoHeight:true,seeNum:4,slideNum:1,isTurn:false,border:null,autoSlide:false,slideTime:3000};var g=this;var b=a.extend({},a.fn.Zslide.defaults,o);var j=g.find(b.boxRe);var k=g.find(b.boxAb);var n=g.find(b.chd);var c=parseInt(n.css("padding-left"))+parseInt(n.css("padding-right"))+parseInt(n.css("margin-left"))+parseInt(n.css("margin-right"))+n.width();if(b.border){c+=parseInt(b.border)}j.width(c*b.seeNum-parseInt(n.css("margin-left"))-parseInt(n.css("margin-right")));j.css({overflow:"hidden",position:"relative",margin:"auto"});if(b.autoHeight){chdHeight=n.height()+parseInt(n.css("margin-top"))+parseInt(n.css("margin-bottom"));if(b.border){chdHeight+=parseInt(b.border)}j.height(chdHeight)}k.width(c*n.length);k.css({position:"absolute",left:0,top:0});if(b.autoHeight){k.height(chdHeight)}var f=function(){var q=document.cookie.indexOf("preItem=");if(q!=-1){preItem[g.selector]=c}else{var p=new Date();p.setDate(p.getDate()+1);document.cookie="preItem=1;expires="+p.toGMTString();preItem=new Array();preItem[g.selector]=c}};var i=function(){var q=document.cookie.indexOf("preItem=");if(q!=-1){var p=new Date();p.setTime(p.getTime()-10000);document.cookie="preItem=1;expires="+p.toGMTString()}};var l=function(){var t=g.find(b.boxAb);var s=g.find(b.chd);var q=parseInt(s.css("padding-left"))+parseInt(s.css("padding-right"))+parseInt(s.css("margin-left"))+parseInt(s.css("margin-right"))+s.width();if(b.border){q+=parseInt(b.border)}if(b.type=="slide"){if(!t.is(":animated")){var p=parseInt(t.css("left"));var r=t.width()-(t.width()%(q*b.slideNum));if(b.slideNum==1&&b.isTurn){r=t.width()-q*b.seeNum}if(p!=0){t.animate({left:"+="+q*b.slideNum})}else{if(p==0&&b.isTurn){t.animate({left:-r})}}}}};var e=function(){var t=g.find(b.boxAb);var s=g.find(b.chd);var q=parseInt(s.css("padding-left"))+parseInt(s.css("padding-right"))+parseInt(s.css("margin-left"))+parseInt(s.css("margin-right"))+s.width();if(b.border){q+=parseInt(b.border)}if(b.type=="slide"){if(!t.is(":animated")){var r=k.width()-q;var p=parseInt(t.css("left"))-(b.slideNum==1?q*b.seeNum:q*b.slideNum);if(p>=-r){t.animate({left:"-="+q*b.slideNum})}else{if(b.autoSlide||b.isTurn){t.animate({left:0})}}}}};var m=function(){if(b.type=="slide"){var s=preItem[g.selector];var t=g.find(b.chd);var q=parseInt(t.css("padding-left"))+parseInt(t.css("padding-right"))+parseInt(t.css("margin-left"))+parseInt(t.css("margin-right"))+t.width();if(b.border){q+=parseInt(b.border)}var p=Math.abs(parseInt(k.css("left")));var r=(q*p)/s;preItem[g.selector]=q;j.width(q*b.seeNum-parseInt(t.css("margin-left"))-parseInt(t.css("margin-right")));j.css({overflow:"hidden",position:"relative",margin:"auto"});if(b.autoHeight){_chdHeight=t.height()+parseInt(t.css("margin-top"))+parseInt(t.css("margin-bottom"));if(b.border){_chdHeight+=parseInt(b.border)}j.height(_chdHeight)}k.width(q*t.length);k.css({position:"absolute",left:-r,top:0});if(b.autoHeight){k.height(_chdHeight)}}};var h=null;a(window).resize(function(){if(h){clearTimeout(h)}h=setTimeout(function(){if(b.type=="slide"){m()}},50)});if(b.type=="slide"){a(window).load(function(){i()});f()}a(b.left).click(function(){l()});a(b.right).click(function(){e()});if(b.autoSlide){var d=setInterval(function(){e()},b.slideTime);n.hover(function(){clearInterval(d)},function(){d=setInterval(function(){e()},b.slideTime)})}}})(jQuery);